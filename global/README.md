# Google Cloud Foundation Blueprint

This directory contains Terraform configuration for the dpgraham.com organization foundation on Google Cloud.
it was generated by the Google cloud via the [setup checklist](https://cloud.google.com/docs/enterprise/setup-checklist)
and is based on the [security foundations blueprint](https://cloud.google.com/architecture/security-foundations).

## Notes

The easiest way to set up this organization is to use the cloud shell. When an organization is made on Google cloud,
a setup project is made with it, I used the setup project to store terraform state (for this, and the individual
environments).

## Authentication and Authorization

These terraform configs are intended to be run by the organization owner, dpgraham4401@dpgraham.com.

## Prerequisites

To run the commands described in this document, you need the following:

1. Install the [Google Cloud SDK](https://cloud.google.com/sdk/install) version 319.0.0 or later
2. Install [Terraform](https://www.terraform.io/downloads.html) version 0.13.7 or later.
3. Set up a Google Cloud
   [organization](https://cloud.google.com/resource-manager/docs/creating-managing-organization).
4. Set up a Google Cloud
   [billing account](https://cloud.google.com/billing/docs/how-to/manage-billing-account).
5. For the user who will run the Terraform install, grant the
   following roles:
    - The `roles/billing.admin` role on the billing account.
    - The `roles/resourcemanager.organizationAdmin` role on the Google
      Cloud organization.
    - The `roles/resourcemanager.folderCreator` role on the Google
      Cloud organization.
    - The `roles/resourcemanager.projectCreator` role on the Google
      Cloud organization.

## Deploying

From the Cloud shell with a user that has the above permissions:

1. Run `terraform init`.
2. Run `terraform plan` and review the output.
3. Run `terraform apply`.

## Next steps

Once you have the basic foundation deployed, you should explore:

1. Building an [advanced foundation](https://github.com/terraform-google-modules/terraform-example-foundation) using the
   security blueprint
2. Automatically deploying Terraform
   with [Cloud Build](https://cloud.google.com/architecture/managing-infrastructure-as-code)

